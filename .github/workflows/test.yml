name: Issue Autobuild Workflow

on:
  issues:
    types:
      - opened

jobs:
  autobuild:
    runs-on: ubuntu-latest
    steps:
      - name: Check if issue has the "docker-autobuild" label
        id: check-label
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          if [[ "$(gh api issues/\$GITHUB_ISSUE_NUMBER/labels | jq '.[].name' | grep -E 'docker-autobuild')" ]]; then
            has_label="true"
          else
            has_label="false"
          fi
          echo "has_label=$has_label" >> $GITHUB_ENV
      - name: Checkout code
        if: env.has_label == 'true'
        uses: actions/checkout@v2
